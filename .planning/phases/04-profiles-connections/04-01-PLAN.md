---
phase: 04-profiles-connections
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/user/user-avatar.tsx
  - components/profile/profile-header.tsx
  - components/profile/profile-stats-row.tsx
  - components/profile/profile-skeleton.tsx
  - hooks/use-colors.ts
autonomous: true

must_haves:
  truths:
    - "Profile header displays user avatar, name, and bio"
    - "Avatar shows initials fallback when no image"
    - "Stats row shows follower and following counts"
    - "Stats row counts are tappable (navigable)"
    - "Loading skeleton appears while profile loads"
  artifacts:
    - path: "components/user/user-avatar.tsx"
      provides: "Reusable avatar with image and initials fallback"
      exports: ["UserAvatar"]
    - path: "components/profile/profile-header.tsx"
      provides: "Profile header with avatar, name, bio layout"
      exports: ["ProfileHeader"]
    - path: "components/profile/profile-stats-row.tsx"
      provides: "Twitter-style follower/following counts"
      exports: ["ProfileStatsRow"]
    - path: "components/profile/profile-skeleton.tsx"
      provides: "Loading skeleton for profile"
      exports: ["ProfileSkeleton"]
  key_links:
    - from: "components/profile/profile-header.tsx"
      to: "components/user/user-avatar.tsx"
      via: "import UserAvatar"
      pattern: "import.*UserAvatar"
    - from: "components/profile/profile-stats-row.tsx"
      to: "expo-router"
      via: "router.push for navigation"
      pattern: "router\\.push"
---

<objective>
Create reusable profile UI components: avatar, header, stats row, and loading skeleton.

Purpose: Foundation components for all profile screens (own profile, other users)
Output: Four components following selah-web design patterns
</objective>

<execution_context>
@/Users/jay/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jay/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/04-profiles-connections/04-CONTEXT.md
@.planning/phases/04-profiles-connections/04-RESEARCH.md
@components/verse/reflection-item.tsx (avatar pattern)
@hooks/use-colors.ts (if exists, else create)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create UserAvatar component</name>
  <files>components/user/user-avatar.tsx</files>
  <action>
Create reusable avatar component following the pattern from ReflectionItem:

```typescript
interface UserAvatarProps {
  imageUrl?: string | null;
  name?: string | null;
  size?: number;  // Default 40
  onPress?: () => void;
}
```

Features:
- Use expo-image for image display with `contentFit="cover"` and `transition={150}`
- Show initials fallback (first letter or first two letters of name parts)
- Fallback style: circular background with accent color at 18% opacity, centered initials
- Support optional onPress with Pressable wrapper
- Apply borderRadius as size/2 for circular shape
- Use useColors hook for theming (create hook if needed)

Based on ReflectionItem lines 347-365 avatar rendering pattern.
  </action>
  <verify>TypeScript compiles without errors: `npx tsc --noEmit`</verify>
  <done>UserAvatar renders image when provided, initials fallback when not, supports tap handler</done>
</task>

<task type="auto">
  <name>Task 2: Create ProfileHeader and ProfileStatsRow components</name>
  <files>components/profile/profile-header.tsx, components/profile/profile-stats-row.tsx</files>
  <action>
**ProfileHeader** - Clean minimal layout matching selah-web:

```typescript
interface ProfileHeaderProps {
  name?: string | null;
  username?: string | null;
  bio?: string | null;
  imageUrl?: string | null;
  onAvatarPress?: () => void;  // For edit profile tap
  children?: React.ReactNode;  // Slot for action button (Edit Profile or Follow)
}
```

Layout (matching selah-web user-profile-page.tsx lines 50-93):
- Large avatar (80px) at top
- Name (bold, 20px) below avatar
- Username (@username, muted color) below name
- Bio text below username
- Children slot below bio for action buttons
- Use NativeWind classes for styling

**ProfileStatsRow** - Twitter-style tappable counts:

```typescript
interface ProfileStatsRowProps {
  userId: string;
  followerCount: number;
  followingCount: number;
}
```

Layout (matching selah-web lines 75-88):
- Horizontal row with gap
- Each stat is Pressable: tap navigates to list
- Format: "{count} Following" and "{count} Followers"
- Count in bold, label in muted color
- Use router.push(`/following/${userId}`) and router.push(`/followers/${userId}`)
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>ProfileHeader displays avatar/name/bio with action slot; ProfileStatsRow shows tappable follower/following counts</done>
</task>

<task type="auto">
  <name>Task 3: Create ProfileSkeleton and useColors hook</name>
  <files>components/profile/profile-skeleton.tsx, hooks/use-colors.ts</files>
  <action>
**useColors hook** - Centralize theme colors:

Extract the colors object pattern used in ReflectionItem (lines 131-140) and verse screens into a reusable hook:

```typescript
export function useColors() {
  // Use resolvedTheme from ThemeProvider to determine light/dark
  // Return color object matching the existing pattern
  return {
    bg: string;
    surface: string;
    surfaceElevated: string;
    border: string;
    text: string;
    textSecondary: string;
    textMuted: string;
    accent: string;
  };
}
```

Read theme values from NAV_THEME in constants/theme.ts or derive from NativeWind CSS variables.

**ProfileSkeleton** - Loading state:

```typescript
interface ProfileSkeletonProps {
  // No props needed - fixed layout
}
```

Show placeholder skeleton while profile loads:
- Circular avatar placeholder (80px, pulsing opacity animation)
- Two text line placeholders for name/username
- One longer placeholder for bio
- Stats row placeholder

Use Animated.View with opacity animation (0.3 to 1.0 loop) for pulse effect.
Use surfaceElevated color for skeleton blocks.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>useColors hook provides theme colors; ProfileSkeleton shows animated loading placeholders</done>
</task>

</tasks>

<verification>
1. All files compile: `npx tsc --noEmit` passes
2. Components export correctly: imports resolve in test file
3. UserAvatar shows image or initials based on props
4. ProfileStatsRow counts are pressable (onPress handler defined)
5. ProfileSkeleton animates opacity for loading effect
</verification>

<success_criteria>
- Four components created in components/user/ and components/profile/
- useColors hook extracts theme colors for reuse
- All components follow selah-web design patterns
- TypeScript compilation successful
</success_criteria>

<output>
After completion, create `.planning/phases/04-profiles-connections/04-01-SUMMARY.md`
</output>
