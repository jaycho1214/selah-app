---
phase: 01-foundation
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - babel.config.js
  - metro.config.js
  - tailwind.config.ts
  - global.css
  - app/_layout.tsx
  - lib/utils.ts
  - components/ui/text.tsx
  - components/ui/button.tsx
  - components/ui/card.tsx
  - nativewind-env.d.ts
autonomous: true

must_haves:
  truths:
    - "NativeWind styles apply to components (className prop works)"
    - "Tailwind utility classes render correct styles"
    - "react-native-reusables components are installed and usable"
    - "cn() utility function works for conditional classes"
  artifacts:
    - path: "tailwind.config.ts"
      provides: "Tailwind configuration with NativeWind preset"
      contains: "nativewind/preset"
    - path: "global.css"
      provides: "CSS with Tailwind directives"
      contains: "@tailwind base"
    - path: "metro.config.js"
      provides: "Metro config with NativeWind wrapper"
      contains: "withNativeWind"
    - path: "lib/utils.ts"
      provides: "cn() class merge utility"
      exports: ["cn"]
    - path: "components/ui/button.tsx"
      provides: "Reusable button component"
      exports: ["Button"]
    - path: "components/ui/text.tsx"
      provides: "Styled text component"
      exports: ["Text"]
  key_links:
    - from: "app/_layout.tsx"
      to: "global.css"
      via: "import statement at top"
      pattern: "import.*global\\.css"
    - from: "metro.config.js"
      to: "global.css"
      via: "withNativeWind input option"
      pattern: "input:.*global\\.css"
---

<objective>
Configure NativeWind v4 with Tailwind CSS 3.4.x and add react-native-reusables UI components.

Purpose: Establish the styling system and component library that matches selah-web's design patterns.
Output: Working Tailwind CSS styling with reusable UI components.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-RESEARCH.md
@package.json
@app/_layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install and configure NativeWind v4</name>
  <files>
    package.json
    babel.config.js
    metro.config.js
    tailwind.config.ts
    global.css
    nativewind-env.d.ts
    app/_layout.tsx
  </files>
  <action>
    1. Install NativeWind and Tailwind dependencies:
       ```bash
       npm install nativewind
       npm install -D tailwindcss@^3.4.17
       ```
       CRITICAL: Use Tailwind 3.4.x, NOT v4.x. NativeWind v4 is incompatible with Tailwind v4.

    2. Create `tailwind.config.ts` in project root:
       ```typescript
       import type { Config } from 'tailwindcss';

       export default {
         content: [
           './app/**/*.{js,jsx,ts,tsx}',
           './components/**/*.{js,jsx,ts,tsx}',
         ],
         presets: [require('nativewind/preset')],
         theme: {
           extend: {
             // Theme colors will be added in Plan 04
           },
         },
         plugins: [],
       } satisfies Config;
       ```

    3. Create `global.css` in project root:
       ```css
       @tailwind base;
       @tailwind components;
       @tailwind utilities;
       ```
       Note: Theme CSS variables will be added in Plan 04.

    4. Update `babel.config.js`:
       ```javascript
       module.exports = function (api) {
         api.cache(true);
         return {
           presets: [
             ['babel-preset-expo', { jsxImportSource: 'nativewind' }],
             'nativewind/babel',
           ],
           plugins: ['relay'],  // Keep relay plugin from Plan 02
         };
       };
       ```

    5. Create or update `metro.config.js`:
       ```javascript
       const { getDefaultConfig } = require('expo/metro-config');
       const { withNativeWind } = require('nativewind/metro');

       const config = getDefaultConfig(__dirname);

       module.exports = withNativeWind(config, { input: './global.css' });
       ```

    6. Create `nativewind-env.d.ts` in project root for TypeScript support:
       ```typescript
       /// <reference types="nativewind/types" />
       ```

    7. Update `app/_layout.tsx`:
       - Add `import '../global.css';` at the VERY TOP (before any component imports)
       - This is critical - CSS must be imported first

    8. Clear caches and restart:
       ```bash
       rm -rf node_modules/.cache .expo
       npx expo start -c
       ```
  </action>
  <verify>
    - No build errors when running `npx expo start -c`
    - Add a test className to any component (e.g., `className="bg-red-500"`)
    - The red background should appear
    - TypeScript recognizes className prop without errors
  </verify>
  <done>
    NativeWind configured; Tailwind classes apply to components.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add react-native-reusables components and utilities</name>
  <files>
    lib/utils.ts
    components/ui/text.tsx
    components/ui/button.tsx
    components/ui/card.tsx
  </files>
  <action>
    1. Install required peer dependencies for react-native-reusables:
       ```bash
       npm install clsx tailwind-merge class-variance-authority
       npm install lucide-react-native react-native-svg
       npx expo install react-native-svg  # Ensure Expo-compatible version
       ```

    2. Create `lib/utils.ts`:
       ```typescript
       import { clsx, type ClassValue } from 'clsx';
       import { twMerge } from 'tailwind-merge';

       export function cn(...inputs: ClassValue[]) {
         return twMerge(clsx(inputs));
       }
       ```

    3. Use react-native-reusables CLI to add components:
       ```bash
       npx @react-native-reusables/cli@latest add text button card
       ```

       If CLI prompts for configuration:
       - Components directory: components/ui
       - Utils path: lib/utils
       - Style: default

       If CLI fails for existing project, create components manually based on
       the react-native-reusables documentation patterns.

    4. If CLI doesn't work, create components manually:

       `components/ui/text.tsx`:
       ```typescript
       import * as React from 'react';
       import { Text as RNText, TextProps as RNTextProps } from 'react-native';
       import { cn } from '@/lib/utils';

       interface TextProps extends RNTextProps {
         className?: string;
       }

       const Text = React.forwardRef<RNText, TextProps>(
         ({ className, ...props }, ref) => {
           return (
             <RNText
               ref={ref}
               className={cn('text-foreground', className)}
               {...props}
             />
           );
         }
       );
       Text.displayName = 'Text';

       export { Text };
       ```

       `components/ui/button.tsx`:
       ```typescript
       import * as React from 'react';
       import { Pressable, PressableProps, View } from 'react-native';
       import { cva, type VariantProps } from 'class-variance-authority';
       import { cn } from '@/lib/utils';
       import { Text } from './text';

       const buttonVariants = cva(
         'flex-row items-center justify-center rounded-md',
         {
           variants: {
             variant: {
               default: 'bg-primary',
               secondary: 'bg-secondary',
               destructive: 'bg-destructive',
               outline: 'border border-border bg-transparent',
               ghost: 'bg-transparent',
             },
             size: {
               default: 'h-10 px-4 py-2',
               sm: 'h-9 px-3',
               lg: 'h-11 px-8',
               icon: 'h-10 w-10',
             },
           },
           defaultVariants: {
             variant: 'default',
             size: 'default',
           },
         }
       );

       const buttonTextVariants = cva('text-sm font-medium', {
         variants: {
           variant: {
             default: 'text-primary-foreground',
             secondary: 'text-secondary-foreground',
             destructive: 'text-destructive-foreground',
             outline: 'text-foreground',
             ghost: 'text-foreground',
           },
         },
         defaultVariants: {
           variant: 'default',
         },
       });

       interface ButtonProps
         extends PressableProps,
           VariantProps<typeof buttonVariants> {
         className?: string;
         textClassName?: string;
         children?: React.ReactNode;
       }

       const Button = React.forwardRef<View, ButtonProps>(
         ({ className, textClassName, variant, size, children, ...props }, ref) => {
           return (
             <Pressable
               ref={ref}
               className={cn(buttonVariants({ variant, size }), className)}
               {...props}
             >
               {typeof children === 'string' ? (
                 <Text className={cn(buttonTextVariants({ variant }), textClassName)}>
                   {children}
                 </Text>
               ) : (
                 children
               )}
             </Pressable>
           );
         }
       );
       Button.displayName = 'Button';

       export { Button, buttonVariants, buttonTextVariants };
       ```

       `components/ui/card.tsx`:
       ```typescript
       import * as React from 'react';
       import { View, ViewProps } from 'react-native';
       import { cn } from '@/lib/utils';
       import { Text } from './text';

       interface CardProps extends ViewProps {
         className?: string;
       }

       const Card = React.forwardRef<View, CardProps>(
         ({ className, ...props }, ref) => (
           <View
             ref={ref}
             className={cn('rounded-lg border border-border bg-card p-4', className)}
             {...props}
           />
         )
       );
       Card.displayName = 'Card';

       const CardHeader = React.forwardRef<View, CardProps>(
         ({ className, ...props }, ref) => (
           <View ref={ref} className={cn('pb-2', className)} {...props} />
         )
       );
       CardHeader.displayName = 'CardHeader';

       const CardTitle = React.forwardRef<View, CardProps & { children?: React.ReactNode }>(
         ({ className, children, ...props }, ref) => (
           <Text className={cn('text-lg font-semibold', className)} {...props}>
             {children}
           </Text>
         )
       );
       CardTitle.displayName = 'CardTitle';

       const CardContent = React.forwardRef<View, CardProps>(
         ({ className, ...props }, ref) => (
           <View ref={ref} className={cn('pt-0', className)} {...props} />
         )
       );
       CardContent.displayName = 'CardContent';

       export { Card, CardHeader, CardTitle, CardContent };
       ```

    5. Create `components/ui/index.ts` for easier imports:
       ```typescript
       export * from './text';
       export * from './button';
       export * from './card';
       ```
  </action>
  <verify>
    - `lib/utils.ts` exports cn() function
    - Components exist in `components/ui/`
    - Import and use Button in a test screen:
      ```tsx
      import { Button } from '@/components/ui/button';
      <Button onPress={() => console.log('pressed')}>Test Button</Button>
      ```
    - Button renders (may not have correct colors until Plan 04 adds theme)
  </verify>
  <done>
    cn() utility and react-native-reusables components (Text, Button, Card) installed and working.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update tab screens to use new components</name>
  <files>
    app/(tabs)/index.tsx
    app/(tabs)/explore.tsx
    app/(tabs)/profile.tsx
  </files>
  <action>
    Update all tab screens to use the new NativeWind styling and components:

    1. Replace ThemedView/ThemedText with NativeWind-styled Views:
       - Use `className` prop instead of inline styles
       - Use View from react-native with className
       - Use Text from components/ui/text

    2. Example pattern for each screen:
       ```tsx
       import { View } from 'react-native';
       import { Text } from '@/components/ui/text';
       import { Button } from '@/components/ui/button';

       export default function HomeScreen() {
         return (
           <View className="flex-1 items-center justify-center bg-background p-4">
             <Text className="text-2xl font-bold mb-2">Home</Text>
             <Text className="text-muted-foreground mb-4">
               Your feed will appear here
             </Text>
             <Button variant="outline" onPress={() => {}}>
               Get Started
             </Button>
           </View>
         );
       }
       ```

    3. Apply to all three screens with appropriate content:
       - Home: Title, subtitle, "Get Started" button
       - Explore: Title, subtitle, "Discover" button
       - Profile: Title, subtitle, "Edit Profile" button

    Note: Colors may not be correct yet (bg-background, text-foreground)
    because theme CSS variables are added in Plan 04. The components should
    still render with fallback colors.
  </action>
  <verify>
    - All three tabs render without errors
    - NativeWind classes are applied (check with bg-red-500 temporarily)
    - Button components are visible and interactive
    - Text components render correctly
  </verify>
  <done>
    All tab screens use NativeWind styling and react-native-reusables components.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. `npx expo start -c` - App builds and runs without errors
2. Tailwind classes apply (test with `bg-red-500` on any element)
3. Button component renders and responds to press
4. Text component renders with className prop
5. cn() utility merges classes correctly
6. No TypeScript errors about className
</verification>

<success_criteria>
- NativeWind styles apply to components (className prop works)
- Tailwind utility classes render correct styles
- react-native-reusables components are installed (Button, Text, Card)
- cn() utility function works for conditional classes
- All tab screens use new component library
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-03-SUMMARY.md`
</output>
